<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <title>Upcoming zápasy</title>
</head>
<body>
  <h1>Upcoming zápasy</h1>
  <button id="fetch-btn">Načíst a aktualizovat zápasy</button>
  <div id="results"></div>

  <script>
    document.getElementById('fetch-btn').addEventListener('click', async () => {
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = 'Načítám…';

      try {
        // Spuštění backend fetch a aktualizace
        const res = await fetch('/upcoming');
        const data = await res.json();

        if (data.error) {
          resultsDiv.innerHTML = `Chyba: ${data.error}`;
          return;
        }

        // Získání zápasů z DB
        const matchesRes = await fetch('/api/upcoming-matches');
        const matches = await matchesRes.json();

        if (!Array.isArray(matches)) {
          resultsDiv.innerHTML = 'Chyba při načítání zápasů';
          return;
        }

        if (matches.length === 0) {
          resultsDiv.innerHTML = 'Žádné zápasy k zobrazení';
          return;
        }

        // Vykreslení zápasů
        resultsDiv.innerHTML = '<ul>' + matches.map(m => 
          `<li>${m.home_name} vs ${m.away_name} dne ${m.datum}</li>`).join('') + '</ul>';

      } catch (err) {
        resultsDiv.innerHTML = `Chyba: ${err.message}`;
      }
    });
  </script>
</body>
</html>
